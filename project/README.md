# Мультимодальная Система Прогнозирования Волатильности Акций/ETF

Полнофункциональный проект для бинарной классификации волатильности акций на следующий день (0 - низкая, 1 - высокая) с использованием мультимодальных данных (финансовые + текстовые признаки).

## Cтарт

```bash
pip install -r requirements.txt
git clone https://github.com/yumoxu/stocknet-dataset.git

```

### Запуск пайплайна
```bash
bash run.sh
```

## Структура проекта

| Файл | Описание |
|------|---------|
| `data_preparation.py` | Загрузка и предобработка сырых данных, создание целевой переменной, объединение финансовых и текстовых данных |
| `feature_engineering.py` | Создание признаков: технические индикаторы (RSI, MACD, ATR), временные признаки, анализ тональности текста |
| `model_training.py` | Обучение CatBoost модели с расчетом Feature Importance и SHAP значений |
| `app.py` | Интерфейс Gradio для демонстрации предсказаний с объяснениями |
| `run.sh` | Удобный скрипт для запуска пайплайна |

**Входные данные:**
- Должен быть клонирован репозиторий StockNet:
  ```bash
  git clone https://github.com/yumoxu/stocknet-dataset.git
  ```
- Файл `multimodal_volatility_data.csv` с объединенными финансовыми и текстовыми данными
- Целевая переменная: бинарная волатильность (0/1)

**Создаваемые признаки:**
- **Технические индикаторы:** RSI, MACD, ATR, Volume MA5
- **Временные признаки:** день недели, месяц, квартал
- **Текстовые признаки:** тональность (позитивная, негативная, нейтральная) и сам текст для CatBoost

**Выход:**
- Файл `final_features_data.csv` с готовыми признаками

**Выход:**
- Обученная модель: `models/catboost_model.cbm`
- Feature Importance: `models/feature_importance.csv`
- SHAP значения: `models/shap_values.csv`

**Gradio:**
- Выбор актива (Ticker)
- Выбор даты для анализа
- Предсказание волатильности
- Объяснение с использованием SHAP значений или Feature Importance
- Доступ: http://127.0.0.1:7860
